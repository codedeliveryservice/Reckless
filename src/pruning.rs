const MEAN: [f32; 13] = [
    2.10926247,
    0.32679400,
    -83.58889008,
    20.82774925,
    -131.34480286,
    0.51119930,
    0.09613085,
    0.02544898,
    10.85548592,
    9271.03515625,
    -4.62278509,
    -14.15410805,
    1.63219821,
];
const STD: [f32; 13] = [
    1.01967609,
    0.46904117,
    565.00775146,
    242.04344177,
    2700.09521484,
    0.49987447,
    0.29477060,
    0.15748441,
    1.77566981,
    12401.96679688,
    93.51278687,
    280.69226074,
    4.52272701,
];

const W1: [[f32; 13]; 32] = [
    [
        0.11362356,
        -0.05868643,
        0.25337592,
        0.45373705,
        -0.10741702,
        -0.00095824,
        -0.51676399,
        0.10446279,
        0.05953449,
        0.11766748,
        -0.33122155,
        0.24716631,
        0.26327151,
    ],
    [
        0.15049089,
        0.00924237,
        0.01691687,
        -0.04879602,
        -0.94828993,
        0.25175813,
        -0.15307754,
        -0.17086609,
        0.08629322,
        -0.21823540,
        -0.32220894,
        -0.00436061,
        -0.37978557,
    ],
    [
        -0.00715251,
        0.06283620,
        -0.19139747,
        -0.23175651,
        0.24034683,
        -0.25381699,
        0.29107884,
        -0.37614548,
        0.07946435,
        0.67877191,
        -0.32131287,
        -0.12037694,
        -0.49346274,
    ],
    [
        0.20253068,
        0.49025798,
        0.21356411,
        0.43101782,
        -0.12284119,
        0.52442443,
        -0.04159897,
        0.15651882,
        -0.10678436,
        0.14731741,
        -0.03787352,
        0.18779908,
        0.15777953,
    ],
    [
        -0.03960073,
        0.02185221,
        0.56915903,
        0.05990508,
        0.04603634,
        -0.45206928,
        -0.03384639,
        -0.55415672,
        0.06344999,
        0.15942991,
        -0.75938904,
        0.15252759,
        -0.02200753,
    ],
    [
        -0.62418157,
        -0.02459043,
        -0.05787530,
        -0.08400742,
        0.94922721,
        0.41728401,
        -0.01728249,
        -0.15071736,
        -0.10606517,
        0.58430213,
        0.35338899,
        0.11681727,
        0.42183253,
    ],
    [
        -0.14936437,
        0.12714110,
        -0.30326724,
        -0.08004021,
        -0.72079748,
        -0.06755532,
        -0.04974449,
        -0.04151101,
        0.04881868,
        -0.05392012,
        -0.56182051,
        0.23686081,
        -0.05072694,
    ],
    [
        -0.65818119,
        0.10918089,
        -0.01890219,
        -0.24877946,
        -0.29288980,
        -0.18304588,
        0.19488984,
        0.17713575,
        -0.36892414,
        -0.03848032,
        0.10117065,
        0.01569019,
        0.48444694,
    ],
    [
        -0.19674878,
        -0.40953004,
        0.08501395,
        0.74105871,
        0.22634754,
        0.03967286,
        0.02160946,
        0.20989636,
        0.02043789,
        0.68074447,
        -0.11625640,
        -0.03996824,
        -0.12813234,
    ],
    [
        -0.04444765,
        -0.03112987,
        -0.03151589,
        0.20178263,
        0.03098879,
        -0.58999211,
        -0.28501591,
        -0.00507721,
        -0.02918883,
        -0.10585214,
        -0.03541058,
        -0.03126728,
        -2.01258922,
    ],
    [
        -0.23387393,
        0.11936779,
        0.02655174,
        0.03654796,
        0.63063484,
        -0.11773171,
        0.01382023,
        0.09880890,
        0.06367423,
        0.55389965,
        -0.65753019,
        -0.07278843,
        -0.10796189,
    ],
    [
        0.09632243,
        0.16936876,
        -0.11547488,
        0.04601002,
        0.67983383,
        -0.06611031,
        0.19669406,
        -0.08195361,
        0.00228432,
        0.48878828,
        -0.12279265,
        -0.41961586,
        -0.06166200,
    ],
    [
        -0.03152388,
        -0.11396213,
        -0.59911978,
        0.70021474,
        -0.65884066,
        0.17697157,
        -0.53517729,
        -0.21064168,
        0.01525667,
        0.45318037,
        -0.65585011,
        0.67175573,
        0.02304329,
    ],
    [
        1.14523995,
        -0.03545531,
        0.64808869,
        0.30666044,
        0.28687692,
        -0.05465567,
        0.25546125,
        -0.29282346,
        -0.06639657,
        0.01780788,
        -0.31556907,
        -0.17684563,
        -0.03953462,
    ],
    [
        0.08509112,
        -0.03365435,
        0.21610822,
        -0.08814669,
        -1.26023734,
        -0.77886808,
        -0.69488508,
        0.40350664,
        -0.02780300,
        0.25673616,
        -0.60881495,
        0.05137776,
        -0.25149730,
    ],
    [
        0.08505321,
        0.05260215,
        -0.44285244,
        0.15428354,
        -0.60768116,
        0.04679953,
        -0.63034236,
        0.00834191,
        -0.05673514,
        -0.44117320,
        -0.20537785,
        0.66422826,
        -0.02262911,
    ],
    [
        0.06805204,
        -0.11418486,
        -0.00038756,
        0.03044962,
        -0.81203204,
        0.45812678,
        0.07666768,
        -0.31749719,
        0.01471282,
        0.10347804,
        -0.64831781,
        -0.06962685,
        0.18203160,
    ],
    [
        0.17919157,
        0.00035523,
        -0.03664685,
        -0.36573595,
        -0.56810188,
        0.30456558,
        -0.41366780,
        0.03817341,
        -0.00596889,
        -0.79313314,
        0.17668532,
        0.06787500,
        -0.26119322,
    ],
    [
        0.72230041,
        -0.02514124,
        0.33245492,
        0.01416410,
        0.53788263,
        -0.03851683,
        0.60936326,
        0.58309042,
        -0.06272938,
        -0.23087242,
        -0.09987449,
        -0.17264761,
        -0.28690308,
    ],
    [
        0.35711035,
        -0.91917348,
        0.35440522,
        -0.02767557,
        -0.16995911,
        -0.46832612,
        0.45201412,
        -0.29397985,
        -0.00788892,
        -0.51634163,
        -0.06315036,
        -0.44686338,
        0.31503743,
    ],
    [
        -0.24660444,
        0.02923870,
        -0.77588379,
        -0.01406391,
        0.18505214,
        0.02757051,
        -0.68250799,
        0.15661082,
        0.01048895,
        0.72211683,
        0.05067152,
        0.01200678,
        -0.06122760,
    ],
    [
        -0.23847210,
        -0.37253040,
        0.14716093,
        0.22180091,
        0.29020303,
        0.05461477,
        -0.06945455,
        -0.10039566,
        0.01541165,
        0.59249187,
        -0.37480637,
        0.07162209,
        0.03058719,
    ],
    [
        -0.12162807,
        0.12191223,
        0.60038525,
        -0.18886602,
        0.03525247,
        -0.13057670,
        0.13094294,
        -0.28383958,
        -0.03529146,
        -0.63625908,
        0.30182871,
        -0.40717635,
        -0.35238880,
    ],
    [
        0.03917011,
        0.02711810,
        0.60378170,
        -1.01213849,
        -0.49971879,
        -0.05892096,
        0.02349563,
        0.14453475,
        -0.03583253,
        0.25072590,
        -0.05847557,
        -0.69271749,
        0.18474995,
    ],
    [
        0.54355490,
        0.04780386,
        0.12206341,
        0.06892943,
        -0.01655255,
        0.55792707,
        0.23420423,
        0.35730726,
        -0.12405205,
        0.72167575,
        -0.68598920,
        -0.06633271,
        0.47232416,
    ],
    [
        1.53847611,
        -0.06226249,
        -0.34086099,
        0.26561946,
        0.18795395,
        0.03048069,
        -0.01389170,
        -0.44361976,
        0.08337852,
        0.08613137,
        0.29680046,
        -0.23763295,
        -0.00156043,
    ],
    [
        -0.09487630,
        -0.33565995,
        -0.32977962,
        0.65456349,
        -0.19301854,
        0.42695999,
        0.12225757,
        0.14231472,
        0.02351223,
        0.06792441,
        0.09501545,
        0.55520791,
        0.17160013,
    ],
    [
        0.03116036,
        -0.00843073,
        0.12671635,
        0.72244793,
        -0.04433563,
        -0.18307568,
        0.20131329,
        -0.92132562,
        0.02065726,
        0.19451503,
        -0.48628464,
        -0.07047840,
        0.14350642,
    ],
    [
        1.14808285,
        0.02442942,
        0.18166348,
        0.01114832,
        0.60736120,
        0.20183945,
        0.00125164,
        0.33161718,
        -0.01467570,
        0.07681755,
        0.03724442,
        -0.03004356,
        0.00884760,
    ],
    [
        0.01774437,
        -0.02438222,
        -0.58735001,
        1.13948524,
        -0.25240174,
        0.16445291,
        0.22106892,
        0.05473102,
        0.01128841,
        -0.14563967,
        0.28431422,
        0.01510648,
        -0.07620645,
    ],
    [
        0.57066965,
        -0.05473220,
        -0.67379326,
        0.25442141,
        0.38287196,
        0.03125285,
        0.08426060,
        0.49809447,
        -0.01908188,
        0.11069645,
        -0.04467791,
        0.35774687,
        0.10777875,
    ],
    [
        -0.00250595,
        0.03579067,
        -0.39952964,
        -0.33025202,
        -0.62811774,
        -0.72261709,
        -0.47247577,
        -0.37917262,
        0.07610171,
        -0.18166573,
        -0.06462906,
        0.07622908,
        -0.89102250,
    ],
];

const B1: [f32; 32] = [
    0.24882998,
    0.22652042,
    0.02563415,
    0.46054757,
    0.50275809,
    -0.27961114,
    -0.14051209,
    -0.02640144,
    0.13196397,
    -0.43156371,
    0.05804214,
    0.47684279,
    -0.50352722,
    0.32131392,
    0.16469708,
    -0.12071669,
    0.10563087,
    -0.43024302,
    0.11179273,
    -0.09016151,
    0.28530884,
    0.27542037,
    0.29119089,
    0.78405845,
    -0.15114865,
    0.03521087,
    0.44755217,
    0.53646636,
    -0.00609190,
    0.51475263,
    -1.06484258,
    0.02532629,
];
const W2: [[f32; 32]; 1] = [[
    0.40987229,
    -0.38560551,
    0.67288309,
    0.26236975,
    0.52844900,
    -0.64677882,
    -0.33848590,
    0.36129400,
    0.52393591,
    -1.20261431,
    0.55664492,
    0.55546838,
    -0.67801011,
    0.62785482,
    -0.62295091,
    0.64517963,
    -0.41739395,
    0.84583163,
    -0.60546523,
    0.32172450,
    -0.81165743,
    0.26994693,
    0.50605184,
    -0.77989542,
    0.54184878,
    -0.75910074,
    0.38840762,
    0.30733606,
    0.78840083,
    0.79133296,
    -1.10722792,
    0.81663889,
]];

const B2: [f32; 1] = [0.24796128];

fn relu(x: f32) -> f32 {
    if x > 0.0 {
        x
    } else {
        0.0
    }
}

fn sigmoid(x: f32) -> f32 {
    1.0 / (1.0 + (-x).exp())
}

fn linear<const OUT: usize, const IN: usize>(
    input: &[f32; IN], weights: &[[f32; IN]; OUT], bias: &[f32; OUT],
) -> [f32; OUT] {
    let mut out = [0.0; OUT];
    for i in 0..OUT {
        out[i] = bias[i];
        for j in 0..IN {
            out[i] += weights[i][j] * input[j];
        }
    }
    out
}

pub fn predict(mut input: [f32; 13]) -> f32 {
    for i in 0..13 {
        input[i] = (input[i] - MEAN[i]) / STD[i];
    }

    let hidden = linear::<32, 13>(&input, &W1, &B1);
    let mut activated = [0.0; 32];
    for i in 0..32 {
        activated[i] = relu(hidden[i]);
    }

    let output = linear::<1, 32>(&activated, &W2, &B2);
    sigmoid(output[0])
}
